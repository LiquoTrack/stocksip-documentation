# Capítulo 4: Solution Software Design #

## _4.1. Strategic-Level Domain Driven Design_ ##

Para entender el dominio y sus límites, utilizamos la técnica de Event Storming. Esta técnica nos permite descubrir los eventos clave del dominio, identificar los actores involucrados y definir los contextos delimitados (bounded contexts) que conforman el sistema.

### 4.1.1. Event Storming ###

El equipo uso la herramienta Miro para llevar a cabo sesiones de Event Storming. A continuación, se presentan los pasos seguidos y los resultados obtenidos en cada fase del proceso:

## Paso 1: Collect Domain Events

Hemos identificado los eventos de dominio clave que representan cambios significativos en el estado del sistema.

<img src="https://i.imgur.com/7GyislK.png" alt="event-storming-step1" style="width: 100%; height: auto;"/>

A partir de estos eventos, hemos comenzado a construir una comprensión compartida del dominio y sus procesos.

## Paso 2: Timelines

Luego de identificar los eventos, los organizamos en líneas de tiempo para visualizar la secuencia y las relaciones entre ellos.

<img src="https://i.imgur.com/MjE09PA.png" alt="event-storming-step2" style="width: 100%; height: auto;"/>

Esto nos permitió identificar flujos de trabajo y dependencias críticas dentro del dominio. 

## Paso 3: Pain Points

Identificamos los puntos de dolor y las áreas problemáticas dentro del dominio que requieren atención especial.

<img src="https://i.imgur.com/pp1Gs8P.png" alt="event-storming-step3" style="width: 100%; height: auto;"/>

Estos puntos de dolor nos ayudaron a priorizar las áreas que necesitan mejoras y a enfocar nuestros esfuerzos en soluciones efectivas.

## Paso 4: Pivotal Events

Luego, destacamos los eventos pivote que tienen un impacto significativo en el flujo del dominio.

<img src="https://i.imgur.com/UTBAD97.png" alt="event-storming-step4" style="width: 100%; height: auto;"/>

Estos eventos pivote nos ayudaron a identificar las áreas críticas del sistema que requieren una atención especial y una gestión cuidadosa.

## Paso 5: Commands

Identificamos los comandos que representan las acciones que los usuarios o sistemas pueden realizar para desencadenar eventos de dominio.

<img src="https://i.imgur.com/u2Vq5nX.png" alt="event-storming-step5" style="width: 100%; height: auto;"/>

Estos comandos nos ayudaron a definir las interacciones clave dentro del sistema y a comprender cómo los usuarios pueden influir en el flujo del dominio.

## Paso 6: Policies

Identificamos las políticas que gobiernan el comportamiento del sistema y las reglas de negocio que deben cumplirse.

<img src="https://i.imgur.com/1w43ACg.png" alt="event-storming-step6" style="width: 100%; height: auto;"/>

Estas políticas nos ayudaron a definir las restricciones y las condiciones bajo las cuales los eventos y comandos pueden ocurrir.

## Paso 7: Read Models

Identificamos los modelos de lectura que representan las vistas y las proyecciones de los datos dentro del sistema.

<img src="https://i.imgur.com/QYUxvJB.png" alt="event-storming-step7" style="width: 100%; height: auto;"/>

Estos modelos de lectura nos ayudaron a definir cómo los datos se presentan a los usuarios y cómo se pueden consultar de manera eficiente.

## Paso 8: External Systems

Identificamos los sistemas externos que interactúan con nuestro dominio y los puntos de integración necesarios.

<img src="https://i.imgur.com/xla1yxt.png" alt="event-storming-step8" style="width: 100%; height: auto;"/>

Estos sistemas externos nos ayudaron a comprender las dependencias y las interacciones fuera de nuestro control directo.

## Paso 9: Aggregates

Finalmente, identificamos los agregados que representan las entidades y los objetos de valor dentro del dominio.

<img src="https://i.imgur.com/fz1d6yR.png" alt="event-storming-step9" style="width: 100%; height: auto;"/>

Estos agregados nos ayudaron a definir las estructuras de datos y las relaciones clave dentro del sistema.

#### 4.1.1.1. Candidate Context Discovery ####

Una vez modelado el dominio mediante Event Storming, el equipo procedió a identificar los bounded contexts candidatos mediante un proceso colaborativo centrado en el valor de negocio y la cohesión del dominio. Para ello, se aplicaron las siguientes técnicas estratégicas:

- **Start-with-value**: Se identificó el área que mayor valor aporta al negocio, enfocándose en los procesos y funcionalidades que impactan directamente en los objetivos estratégicos de la empresa.


- **Start-with-simple**: Se seleccionaron las áreas del dominio que presentan una menor complejidad, facilitando así la implementación y el mantenimiento del sistema.

### 4.1.1.1.1. Inventory Management Context

Para el bounded context de inventory, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/dTJQ5OI.png" alt="inventory-management" style="width: 100%; height: auto;"/>

Hemos decidido delimitar este contexto debido a su alta cohesión interna y su relevancia estratégica para el negocio, ya que gestiona aspectos críticos como el control de inventario, ajustes de stock y seguimiento de movimientos, asegurando la disponibilidad y precisión en tiempo real de los productos.

### 4.1.1.1.2 Customer Orders Context

Para el bounded context de customer orders, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/04bDMnn.png" alt="customer-orders" style="width: 100%; height: auto;"/>

Para este contexto, se ha optado por su delimitación debido a su enfoque específico en la gestión del ciclo completo de pedidos, lo que garantiza una experiencia fluida tanto para clientes como para proveedores, y su capacidad para integrarse eficazmente con otros contextos del sistema.

### 4.1.1.1.3 Sales Operation and Management Context

Para el bounded context de sales operation and management, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/4r7IQmv.png" alt="sales-operation-management" style="width: 100%; height: auto;"/>

Este contexto se ha delimitado debido a su importancia en la toma de decisiones basada en datos, permitiendo a los proveedores visualizar y analizar el desempeño de sus ventas mediante dashboards y ventas realizadas, lo que contribuye directamente al éxito del negocio.

### 4.1.1.1.4 Identity and Access Management Context

Para el bounded context de identity and access management, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/JxgbMXc.png" alt="identity-access-management" style="width: 100%; height: auto;"/>

Para obtener un mejor control de seguridad y gestión de usuarios, se ha decidido delimitar este contexto, ya que maneja aspectos críticos como la autenticación y autorización, asegurando que solo los usuarios autorizados puedan acceder a las funcionalidades del sistema según sus roles y permisos específicos.

### 4.1.1.1.5 Payments and Subscriptions Context

Para el bounded context de payments and subscriptions, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/FCsjGvp.png" alt="payments-subscriptions" style="width: 100%; height: auto;"/>

Para este contexto, se ha optado por su delimitación debido a la necesidad de gestionar de manera eficiente las operaciones relacionadas con los pagos y suscripciones, incluyendo la validación de acceso según el estado del plan contratado, lo que es fundamental para la sostenibilidad financiera del negocio.

### 4.1.1.1.6 Alerts and Notifications Context

Para el bounded context de alerts and notifications, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/Hhix8fc.png" alt="alerts-notifications" style="width: 100%; height: auto;"/>

Este contexto se ha delimitado debido a su papel crucial en la comunicación efectiva de eventos críticos del negocio, como notificaciones de productos próximos a vencer y alertas tempranas de falta de stock, lo que ayuda a mantener la operatividad y satisfacción del cliente.

### 4.1.1.1.7 Profiles Management Context

Para el bounded context de profiles management, se definieron los siguientes elementos clave:

<img src="https://i.imgur.com/2NzcxDi.png" alt="profiles-management" style="width: 100%; height: auto;"/>

Para complementar la gestión de identidad y acceso, se ha decidido delimitar este contexto, ya que se encarga de mantener toda la información relacionada con la identidad digital de los usuarios y sus negocios, lo que es esencial para personalizar la experiencia del usuario y gestionar adecuadamente sus datos.