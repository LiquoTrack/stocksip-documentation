#### 4.1.1.2. Domain Message Flow Modeling ####

La técnica de *Domain Message Flow Modeling* es una extensión del *Event Storming* que se enfoca en la identificación y modelado de los flujos de mensajes dentro del dominio. Esta técnica ayuda a visualizar cómo los diferentes eventos y comandos interactúan entre sí y cómo se propagan a través del sistema.

Para nuestro sistema StockSip, hemos identificado los siguientes flujos de mensajes clave:

4.1.1.2.1. **Registrar un nuevo producto a un catálogo**


 - **Evento**: `ProductRegistered`
 - **Comando**: `RegisterProduct`
 - **Actor**: Proveedor
 - **Descripción**: Cuando un proveedor registra un nuevo producto, se genera el evento `ProductRegistered`, que desencadena el comando `RegisterProduct` para añadir el producto al catálogo.

<img src="https://i.imgur.com/tYdliBQ.png" alt="register-new-product-catalog" style="width: 100%; height: auto;"/>

4.1.1.2.2. **Notificar sobre el estado del pedido**

  - **Evento**: `OrderStatusUpdated`
  - **Comando**: `NotifyOrderStatus`
  - **Actor**: Dueño de licorería
  - **Descripción**: Cuando el estado de un pedido cambia, se genera el evento `OrderStatusUpdated`, que desencadena el comando `NotifyOrderStatus` para informar al dueño de la licorería sobre el nuevo estado del pedido.

<img src="https://i.imgur.com/WspBVJo.png" alt="notify-order-status" style="width: 100%; height: auto;"/>

4.1.1.2.3. **Mostrar todos los almacenes**

  - **Evento**: `WarehousesListed`
  - **Comando**: `GetAllWarehouses`
  - **Actors**: Dueño de licorería o Proveedor
  - **Descripción**: Cuando un usuario solicita ver todos los almacenes, se genera el evento `WarehousesListed`, que desencadena el comando `GetAllWarehouses` para recuperar y mostrar la lista de almacenes disponibles.

<img src="https://i.imgur.com/rjf1FE5.png" alt="view-all-warehouses" style="width: 100%; height: auto;"/>


4.1.1.2.4. **Registrar una nueva cuenta**

  - **Evento**: `AccountRegistered` `PlanSelected`
  - **Comando**: `RegisterAccount` `SelectPlanSubscription`
  - **Actor**: Visitante de la aplicación móvil
  - **Descripción**: Cuando un visitante registra una nueva cuenta, se generan los eventos `AccountRegistered` y `PlanSelected`, que desencadenan los comandos `RegisterAccount` y `SelectPlanSubscription` para crear la cuenta y seleccionar el plan de suscripción.

<img src="https://i.imgur.com/M3lxQMe.png" alt="register-new-account" style="width: 100%; height: auto;"/>

4.1.1.2.5. **Agregar un nuevo producto a un almacén**

  - **Evento**: `ProductAddedToWarehouse`
  - **Comando**: `AddProductToWarehouse`
  - **Actors**: Dueño de licorería y Proveedor
  - **Descripción**: Cuando un producto es agregado a un almacén, se genera el evento `ProductAddedToWarehouse`, que desencadena el comando `AddProductToWarehouse` para actualizar el inventario del almacén con el nuevo producto.

<img src="https://i.imgur.com/tRcTkWC.png" alt="add-new-product-warehouse" style="width: 100%; height: auto;"/>

4.1.1.2.6. **Actualización del estado del pedido**

  - **Evento**: `OrderStatusUpdated` `NotificationReceived`
  - **Comando**: `UpdateOrderStatus` `SendNotification`
  - **Actors**: Dueño de licoría y Proveedor
  - **Descripción**: Cuando el estado de un pedido es actualizado, se generan los eventos `OrderStatusUpdated` y `NotificationReceived`, que desencadenan los comandos `UpdateOrderStatus` y `SendNotification` para reflejar el nuevo estado del pedido y notificar a las partes interesadas.

<img src="https://i.imgur.com/fXV6Lhz.png" alt="update-order-status" style="width: 100%; height: auto;"/>

4.1.1.2.7. **Realizar un pedido**

  - **Evento**: `OrderPlaced` `PaymentProcessed` `NotificationReceived`
  - **Comando**: `PlaceOrder` `MakePayment` `SendNotification`
  - **Actor**: Dueño de licorería and Proveedor
  - **Descripción**: Cuando un dueño de licorería realiza un pedido, se generan los eventos `OrderPlaced`, `PaymentProcessed` y `NotificationReceived`, que desencadenan los comandos `PlaceOrder`, `MakePayment` y `SendNotification` para procesar el pedido, gestionar el pago y notificar al proveedor.

<img src="https://i.imgur.com/ekqiM0B.png" alt="place-order" style="width: 100%; height: auto;"/>

