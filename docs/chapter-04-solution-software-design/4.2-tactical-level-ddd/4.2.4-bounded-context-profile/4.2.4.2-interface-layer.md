#### 4.2.4.2. Interface Layer ####

En esta capa se exponen los controladores HTTP que permiten a clientes externos (aplicaciones web, móviles o integraciones) interactuar con el **Bounded Context Profiles**. Los controladores orquestan la comunicación entre los **Services** y **Domain Layer**, transforman las solicitudes HTTP en **Commands / Queries** y devuelven respuestas adecuadas en forma de resources.

---

## Controllers

| Nombre                        | Descripción                                                                                | Endpoints (ejemplos)                                                                                                                                                                          |
| ----------------------------- | ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ProfilesController**        | Expone operaciones para gestionar perfiles de usuario (creación, actualización, consulta). | `POST /api/profiles` (CreateProfile) — `PUT /api/profiles/{id}` (UpdateProfile) — `GET /api/profiles/{id}` (GetById) — `GET /api/profiles/by-user/{userId}` — `GET /api/profiles?name={name}` |
| **ProfileSettingsController** | Gestiona preferencias y ajustes asociados a un perfil (notificaciones, locale, timezone).  | `GET /api/profiles/{profileId}/settings` (GetSettings) — `PUT /api/profiles/{profileId}/settings` (UpdateSettings) — `PATCH /api/profiles/{profileId}/settings/notifications`                 |
| **ProfileContactsController** | Maneja operaciones sobre contactos asociados a un perfil (teléfonos, emails alternos).     | `POST /api/profiles/{profileId}/contacts` (AddContact) — `PUT /api/profiles/{profileId}/contacts/{contactId}` (UpdateContact) — `DELETE /api/profiles/{profileId}/contacts/{contactId}`       |
| **ProfileAvatarController**   | Responsable de subir / actualizar el avatar del perfil y devolver la URL pública.          | `POST /api/profiles/{profileId}/avatar` (UploadAvatar) — `DELETE /api/profiles/{profileId}/avatar` (RemoveAvatar)                                                                             |

---

## Resources

Los **Resources* modelan las peticiones y respuestas de la API. No contienen lógica de negocio, solo la estructura de datos que el cliente consume o envía.

- **CreateProfileResource**: `{ userId: string, firstName: string, lastName: string, phoneNumber: string, birthDate: string, avatarUrl?: string }`                                                                                     
- **ProfileResource**: `{ id: string, userId: string, fullName: string, firstName: string, lastName: string, contactNumber: string, sex?: string, birthDate?: string, avatarUrl?: string, createdAt: string, updatedAt: string }` 
- ***ProfileSettingsResource**: `{ profileId: string, notifyByEmail: bool, notifyBySms: bool, locale: string, timezone: string, updatedAt: string }`                                                                                
- **ContactResource**:  `{ id: string, type: "phone" "email" | "other", value: string, isPrimary: bool }` 
- **PagedProfilesResource**:  `{ items: ProfileResource[], total: int, page: int, pageSize: int }`                                                                  

---

## Assemblers

- `ProfileFromResourceAssembler` convierte un `CreateProfileResource` o `UpdateProfileResource` en un `CreateProfileCommand` / `UpdateProfileCommand` 
- `ProfileResourceFromEntityAssembler` transforma un agregado `Profile` en un `ProfileResource`                                              
- `ProfileSettingsAssembler` conviente `ProfileSettingsResource` ↔ `UpdateProfileSettingsCommand`                                                                                                                       
- `ContactAssembler` convierte `ContactResource` ↔ entidades `ProfileContact`                                                                                                                 
