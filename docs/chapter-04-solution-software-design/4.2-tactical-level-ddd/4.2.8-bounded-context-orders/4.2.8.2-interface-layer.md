#### 4.2.8.2. Interface Layer ####

En esta capa se exponen los controladores de la API que permiten a los clientes externos (ejemplo: aplicaciones web, móviles o integraciones con otros sistemas) interactuar con el dominio de Procurement Ordering.

Los controladores orquestan la comunicación entre las **Services** y el **Domain Layer**, transforman las solicitudes HTTP en **Commands/Queries**, y devuelven las respuestas adecuadas.

---

## Controllers

| Nombre                      | Descripción                                                       | Endpoints (ejemplos)                                                                                                                                                                                                                                                                     |
|-----------------------------|-------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **PurchaseOrderController** | Expone operaciones para gestionar las órdenes de compra.          | `POST /api/orders (CreatePurchaseOrder), PUT /api/orders/{id} (UpdatePurchaseOrder), DELETE /api/orders/{id} (CancelPurchaseOrder), GET /api/orders/{id}, GET /api/orders/by-buyer/{buyerId}, GET /api/orders/status/{status}`                                                           |
| **CartController**          | Expone operaciones para gestionar carritos de compras temporales. | `POST /api/cart (CreateCart), POST /api/cart/{cartId}/items (AddItem), PUT /api/cart/{cartId}/items/{itemId} (UpdateItem), DELETE /api/cart/{cartId}/items/{itemId} (RemoveItem), POST /api/cart/{cartId}/checkout (Checkout), GET /api/cart/{cartId}, GET /api/cart/by-buyer/{buyerId}` |

---

## Resources

Los controladores utilizarán **Resources** para **mapear las solicitudes y respuestas** de la API, evitando exponer directamente las entidades de dominio. Cada Resource representa la estructura de datos que los clientes externos (frontend, apps móviles u otros servicios) consumirán o enviarán.

- **CreatePurchaseOrderResource**: `{ BuyerId: string, CatalogId: string, Items: [{ ProductId: string, Quantity: int }] }`
- **PurchaseOrderResource**: `{ OrderCode: string, Status: string, TotalToPay: decimal }`
- **CartResource**: `{ CartId: string, BuyerId: string, Items: [{ CatalogItemId: string, Quantity: int, UnitPrice: decimal, SubTotal: decimal }], Total: decimal }`

---

## Assemblers

Se implementan componentes que transforman los Resources ↔ Entities/Aggregates, asegurando que la capa de interfaces no tenga lógica de negocio.


- `PurchaseOrderFromResourceAssembler` convierte un `CreatePurchaseOrderResource` en un `CreatePurchaseOrderCommand`.
- `CartResourceFromEntityAssembler` convierte un `Cart` (dominio) en un `CartResource` (DTO expuesto).
