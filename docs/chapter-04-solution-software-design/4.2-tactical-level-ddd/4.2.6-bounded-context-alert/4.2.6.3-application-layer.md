#### 4.2.6.3. Application Layer ####  

La **Application Layer** orquesta la ejecución de comandos, consultas y el manejo de eventos para los agregados `Alert` y `Notification`, delegando la lógica de negocio a la **Domain Layer** a través de los **CommandServices**, **QueryServices** y **EventHandlers**.

---

## Command Services

Los **Command Services** son responsables de **procesar acciones que modifican el estado del dominio**, como crear, enviar o cancelar alertas y notificaciones.  
Se encargan de recibir los **Commands**, validarlos y delegar la ejecución a los **Domain Services** y **Repositories** correspondientes.

| Nombre                             | Descripción                                                      | Commands manejados                                                                                                        |
|------------------------------------|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| **AlertCommandService**            | Gestiona operaciones sobre las alertas internas del sistema.     | `CreateAlertCommand, UpdateAlertCommand, DeleteAlertCommand`                                                              |
| **NotificationCommandService**     | Gestiona operaciones sobre las notificaciones enviadas a cuentas | `SendNotificationCommand, UpdateNotificationCommand, CancelNotificationCommand`                                           |

---

## Query Services

Los **Query Services** son responsables de **consultar y devolver datos del dominio** sin modificar su estado.  
Reciben **Queries**, consultan los **Repositories** y retornan los resultados al **Controller** o al consumidor de la API.

| Nombre                       | Descripción                                      | Queries manejadas                                                                                                 |
|------------------------------|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| **AlertQueryService**        | Exponer consultas sobre alertas registradas.     | `GetAlertByIdQuery, GetAlertsByAccountQuery, GetAlertsBySeverityQuery, GetAllAlertsQuery`                         |
| **NotificationQueryService** | Exponer consultas sobre notificaciones enviadas. | `GetNotificationByIdQuery, GetNotificationsByAccountQuery, GetNotificationsByTypeQuery, GetAllNotificationsQuery` |

---

## Event Handlers

Los **Event Handlers** reaccionan a eventos generados en otros bounded contexts o dentro del mismo, creando o enviando alertas y notificaciones de manera automática.

| Nombre                         | Descripción                                                                  | Eventos manejados        |
|--------------------------------|------------------------------------------------------------------------------|--------------------------|
| **LowStockEventHandler**       | Genera una alerta crítica cuando un producto alcanza un nivel de stock bajo. | `ProductLowStockEvent`   |
| **OutOfStockEventHandler**     | Genera una alerta y notificación cuando un producto se queda sin stock.      | `ProductOutOfStockEvent` |
| **OrderConfirmedEventHandler** | Envía notificación al comprador cuando su orden ha sido confirmada.          | `OrderConfirmedEvent`    |
| **OrderCompletedEventHandler** | Envía notificación al comprador al completarse su orden.                     | `OrderCompletedEvent`    |
| **ProductExpiredEventHandler** | Genera una alerta crítica cuando un producto alcanza su fecha de expiración. | `ProductExpiredEvent`    |
