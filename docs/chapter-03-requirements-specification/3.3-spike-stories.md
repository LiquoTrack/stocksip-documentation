## _3.3. Spike Stories_ ##

### 3.3.1 **Spike**: Investigar la integración de Google Identity Services (GIS) para registro e inicio de sesión de usuarios en la plataforma de Stocksip.

**Contexto**:  
La Plataforma **Stocksip** consta de una aplicación web construida con **Vue.js 3** y **JavaScript**, una aplicación móvil desarrollada de forma nativa para **Android** utilizando **Kotlin** y **Jetpack Compose** junto a los lineamientos de **Material Design** para la construcción de la interfaz de usuario, además de una aplicación móvil multiplataforma desarrollada con **Flutter** y **Dart**, y un backend implementado con **ASP.NET Core 9** utilizando **C# 13** para servicios RESTful y persistencia de datos en **MongoDB**.
La aplicación web utiliza **PrimeVue** para componentes de interfaz y la biblioteca **Axios** para consumir servicios del backend. La aplicación Android nativa emplea Kotlin y Jetpack Compose para definir pantallas responsivas y adaptadas a Material Design, mientras que la aplicación Flutter proporciona una alternativa multiplataforma con Dart. Ambas aplicaciones móviles interactúan con el backend a través de llamadas HTTP.
El backend ASP.NET Core expone controladores REST para la lógica de negocio, junto con **MongoDB.Driver** para la persistencia de datos, y administra dependencias mediante **NuGet**. El equipo busca integrar **Google Identity Services (GIS)**, aprovechando **OAuth 2.0** y **OpenID Connect**, con el fin de habilitar un registro e inicio de sesión seguro mediante cuentas de Google en las plataformas web y móviles.
Se busca simplificar el flujo de registro, reducir el tiempo de inicio de sesión, mejorar la seguridad al delegar la autenticación a Google, y garantizar conformidad con estándares modernos de identidad digital.


**Spike Story**

**Como** equipo de desarrollo móvil del equipo de Stocksip, **quiero** investigar la integración de la Google Identity Services (GIS) para el registro e inicio de sesión de usuarios en las plataformas , **para** simplificar el flujo de registro, reducir el tiempo de inicio de sesión y garantizar la seguridad del manejo de datos.

**Criterios de Aceptación**:

1. **iniciar sesión y/o registrarse con Google**
    - **Given** un usuario inicia el proceso de login con Google en la app
      **When** la app obtiene un token y lo envía al backend a POST /api/v1/auth/google
      **Then** se valida las claves públicas de Google
      **And** si la validación es correcta y el email no existe, se crea un nuevo usuario

2. **Verificación token y seguridad**
    - **Given** n token recibido por el backend
      **When** el backend lo valida
      **Then** se realiza las omprobaciones mínimas
      **And** se registra o rechaza el intento si la verificación falla

3. **Mapeo de cuentas**
    - **Given** un usuario con email ya existente en la base de datos intenta loguearse con Google que posee el mismo email
      **When** el backend valida token correctamente
      **Then** el sistema debe permite vincular la cuenta de Google a la cuenta local, y actualizar user.google_sub y email_verified sin crear duplicados.

4. **Endpoint para listar usuarios**
   - **Given** una petición autenticada por un cliente autorizado a GET /api/v1/users
     **When** la petición incluye credenciales válidas con permisos de lectura
     **Then** el backend devuelve un listado paginado de usuarios con metadatos mínimos: { id, email, email_verified, provider: "google", google_sub (opcional), created_at, last_login, is_disabled }

**Definition of Done (DoD)**
- La investigación está documentada en un informe técnico.
- Se han identificado las mejores prácticas para la integración de la API de Gmail.
- Los hallazgos se utilizan para crear o refinar historias de implementación en el backlog.

### 3.3.2 **Spike**: Investigar la Integración de Mercado Pago para procesamiento de pagos en la plataforma Stocksip.

**Contexto**:

La Plataforma Stocksip consta de una aplicación web construida con Vue.js 3 y JavaScript, una aplicación móvil desarrollada de forma nativa para Android utilizando Kotlin y Jetpack Compose junto a los lineamientos de Material Design para la construcción de la interfaz de usuario, además de una aplicación móvil multiplataforma desarrollada con Flutter y Dart, y un backend implementado con ASP.NET Core 9 utilizando C# 13 para servicios RESTful y persistencia de datos en MongoDB.
La aplicación web utiliza PrimeVue para componentes de interfaz y la biblioteca Axios para consumir servicios del backend. La aplicación Android nativa emplea Kotlin y Jetpack Compose para definir pantallas responsivas y adaptadas a Material Design, mientras que la aplicación Flutter proporciona una alternativa multiplataforma con Dart. Ambas aplicaciones móviles interactúan con el backend a través de llamadas HTTP.
El backend ASP.NET Core expone controladores REST para la lógica de negocio, junto con MongoDB.Driver para la persistencia de datos, y administra dependencias mediante NuGet.
El equipo busca integrar Mercado Pago mediante el uso de su SDK oficial y APIs REST, con el fin de habilitar pagos seguros, gestión de órdenes y validación de transacciones dentro de las plataformas móviles. Se espera que la integración permita implementar un flujo de checkout transparente y seguro, gestionar pagos con tarjetas de crédito, débito y billeteras digitales soportadas por Mercado Pago.

**Spike Story**

**Como** equipo de desarrollo móvil del equipo de Stocksip, **quiero** investigar la integración de Mercado Pago para el procesamiento de pagos en nuestra aplicación móvil Kotlin y backend ASP.NET Core, **para** que podamos ofrecer a nuestros usuarios una experiencia de pago segura y eficiente.

**Criterios de Aceptación**:

1. **Revisar la documentación de la API de Mercado Pago**
   - **Dado** que el equipo necesita entender las capacidades de Mercado Pago para el procesamiento de pagos en móviles,
   - **Cuando** el desarrollador revisa la coumentación de la API de Mercado Pago (e.g., Checkout Pro, Checkout API, Mobile SDKs, Webhooks),,
   - **Entonces** el desarrollador identifica y documenta el flujo de integración más adecuado (e.g., Checkout Pro para pagos alojados o Checkout API para flujos personalizados en web/móvil) en el informe.
   

2. **Evalua la compatibilidad móvil**
   - **Dado** la arquitectura de Kotlin for Android y Flutter for cross-platform,
   - **Cuando** el desarrollador evalúa la compatibilidad con los Mobile SDKs de Mercado Pago (e.g., Android SDK, Flutter SDK)
   - **Entonces** el desarrollador documenta los requisitos de integración móvil (e.g., manejo de tokens, uso de Webhooks para notificaciones de pago) en el informe.

4. **Evalua la compatibilida del backend**
   - **Dado** el backend ASP.NET Core 9 usando C# 13 para servicios RESTful,
   - **Cuando** el desarrollador evalúa la compatibilidad con la dependencia oficial de c# de Mercado Pago (e.g., MercadoPago.SDK NuGet package)
   - **Entonces** el desarrollador documenta los requisitos de integración del backend (e.g., creación de órdenes, validación de pagos, manejo de Webhooks) en el informe.
    
5. **Identifica Implicaciones de Seguridad**
   - **Dado** la necesidad de garantizar un procesamiento de pagos seguro móvil y backend,
   - **Cuando** el desarrollador analiza los riengos de seguridad potenciales,
   - **Entonces** el desarollador incluye el resumen de riesgos y las características de mitigación de Mercado Pago e (e.g., tokenización del lado del cliente, validación del backend con JWT) en el informe.

6. **Documenta y comparte Hallazgos**
   - **Dado** que el Spike está completo,
   - **Cuando** el desarrollador compila todos sus hallazgos en un informe compartido,
   - **Entonces** el informe incluye pros/contras, enfoque recomendado, y cualquier bloqueador, y es revisado en una reunión de equipo o sesión de refinamiento.

**Definition of Done (DoD)**
- El informe se comparte y revisa en una reunión de equipo o sesión de refinamiento del backlog.
- Los hallazgos se utilizan para crear o refinar historias de implementación en el backlog.
- El Spike está limitado a 5 - 12 horas y se completa dentro del sprint 1.
