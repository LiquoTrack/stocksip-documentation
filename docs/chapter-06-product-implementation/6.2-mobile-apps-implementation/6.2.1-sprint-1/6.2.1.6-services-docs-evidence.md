#### 6.2.1.6. Services Documentation Evidence for Sprint Review 1 ####

En esta sección, se describe la evidencia de documentación de los endpoints que se han implementado en la aplicación backend de nuestro proyecto. A continuacion, se muestra la tabla que contiene una breve descripción de las acciones y requisitos de cada endpoint implementado.

| Módulo         | Endpoint                                                                     | Acción                                    | Verbo HTTP | Sintaxis                                 | Parámetros principales                   | Enlace a Swagger                                                                             |
|----------------|------------------------------------------------------------------------------|-------------------------------------------|------------|------------------------------------------|------------------------------------------|----------------------------------------------------------------------------------------------|
| Accounts       | `/api/v1/accounts/{accountId}/business`                                      | Obtener el business de una cuenta         | GET        | `/accounts/1/business`                   | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/business`                                      | Actualizar el business de una cuenta      | PUT        | `/accounts/1/business`                   | `accountId`, campos nuevos               | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}`                                               | Obtener cuenta por su id                  | GET        | `/accounts/1/care-guides`                | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/care-guides`                                   | Obtener care guides por cuenta            | GET        | `/accounts/1/care-guides`                | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/products`                                      | Obtener productos por cuenta              | GET        | `/accounts/1/products`                   | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/products`                                      | Registrar productos por cuenta            | POST       | `/accounts/1/products`                   | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/warehouses`                                    | Obtener almacenes por cuenta              | GET        | `/accounts/1/warehouses`                 | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/warehouses`                                    | Registrar almacenes por cuenta            | POST       | `/accounts/1/warehouses`                 | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Accounts       | `/api/v1/accounts/{accountId}/alerts`                                        | Obtener alertas por cuenta                | GET        | `/accounts/1/alerts`                     | `accountId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Authentication | `/api/v1/auth/google`                                                        | Registro de cuenta con Google             | POST       | `/.../auth/google`                       | body con nuevos campos para el registro  | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Authentication | `/api/v1/sign-in`                                                            | Inicio de sesión al sistema               | POST       | `/.../sign-in`                           | body con campos para el inicio de sesión | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Authentication | `/api/v1/sign-up`                                                            | Registro de cuenta hacia el sistema       | POST       | `/.../sign-up`                           | body con nuevos campos para el registro  | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Brands         | `/api/v1/brands`                                                             | Obtener todas las marcas                  | GET        | `/.../brands`                            | -                                        | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Care Guides    | `/api/v1/care-guides/{careGuideId}`                                          | Obtener guía por ID                       | GET        | `/api/v1/care-guides/123`                | `careGuideId`, `accountId`               | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Care Guides    | `/api/v1/care-guides/{careGuideId}`                                          | Actualizar guía                           | PUT        | `/api/v1/care-guides/123`                | Body con nuevos campos                   | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Care Guides    | `/api/v1/care-guides/{careGuideId}`                                          | Eliminar guía                             | DELETE     | `/api/v1/care-guides/123`                | `careGuideId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Care Guides    | `/api/v1/care-guides/{careGuideId}/deallocations`                            | Desasignar guía                           | PUT        | `/api/v1/care-guides/123/deallocations`  | `careGuideId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Care Guides    | `/api/v1/care-guides/{careGuideId}/allocations/{productId}`                  | Asignar guía a producto                   | PUT        | `/api/v1/care-guides/123/allocations/45` | `careGuideId`, `productId`               | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Inventories    | `/api/v1/inventories`                                                        | Eliminar un producto de un almacén        | DELETE     | `/.../inventories`                       | -                                        | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Plans          | `/api/v1/plans`                                                              | Obtener todos los planes de suscripción   | GET        | `/.../plans`                             | -                                        | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Products       | `/api/v1/products/{productId}`                                               | Obtener producto por su id                | GET        | `/api/v1/products/1`                     | `productId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Products       | `/api/v1/products/{productId}`                                               | Actualizar producto                       | PUT        | `/api/v1/products/1`                     | `productId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Products       | `/api/v1/products/{productId}`                                               | Eliminar producto                         | DELETE     | `/api/v1/products/1`                     | `productId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Products       | `/api/v1/products`                                                           | Crear producto                            | POST       | `/api/v1/products`                       | -                                        | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Products       | `/api/v1/products/{productId}/minimum-stock`                                 | Actualizar el mínimo stock de un producto | PATCH      | `/api/v1/products/1/minimmum-stock`      | `productId`                              | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Profiles       | `/api/v1/profiles`                                                           | Crear perfil                              | POST       | `/api/v1/profiles`                       | -                                        | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Profiles       | `/api/v1/profiles/{profilesId}`                                              | Obtener todos los perfiles                | GET        | `/api/v1/profiles/1`                     | `profilesId`                             | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Profiles       | `/api/v1/profiles/{profilesId}`                                              | Obtener perfil por su id                  | GET        | `/api/v1/profiles/1`                     | `profilesId`                             | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Profiles       | `/api/v1/profiles/{profilesId}`                                              | Actualizar perfil                         | PUT        | `/api/v1/profiles/1`                     | `profilesId`                             | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Profiles       | `/api/v1/profiles/{profilesId}`                                              | Eliminar perfil                           | DELETE     | `/api/v1/profiles/1`                     | `profilesId`                             | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Users          | `/api/v1/users`                                                              | Obtener un usuario por su id              | GET        | `/.../users`                             | `userId`                                 | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}/products/{productsId}`                     | Obtener productos por almacén             | GET        | `/.../products`                          | `warehouseId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}/products`                                  | Obtener productos por almacén             | GET        | `/.../products`                          | `warehouseId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}/inventories/product/{productId}/additions` | Añadir stock                              | POST       | `.../additions`                          | `warehouseId`, `productId`               | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}/inventories/{productId}/substractions`     | Quitar stock                              | POST       | `.../substractions`                      | `warehouseId`, `productId`               | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}`                                           | Obtener almacén por ID                    | GET        | `/api/v1/warehouses/123`                 | `warehouseId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}`                                           | Actualizar almacén                        | PUT        | `/api/v1/warehouses/123`                 | Body actualizado + `warehouseId`         | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |
| Warehouses     | `/api/v1/warehouses/{warehouseId}`                                           | Eliminar almacén                          | DELETE     | `/api/v1/warehouses/123`                 | `warehouseId`                            | [https://stocksip-back-end.azurewebsites.net/](https://stocksip-back-end.azurewebsites.net/) |

## **Ejemplos Detallados**

## Accounts

---

### 1. Registrar producto en una cuenta

* **Endpoint:** `POST /api/v1/accounts/{accountId}/products`
* **Descripción:** Crea un nuevo producto asociado a la cuenta indicada.

**Ruta**

```http
POST /api/v1/accounts/acc-12345/products
```

**Solicitud (multipart/form-data)**

```
Name=Vodka Premium 750ml
Type=Vodka
Brand=Nordic Spirits
UnitPrice=18.99
Code=VOD-750-PR
MinimumStock=10
Content=0.75
Image=@/ruta/local/producto.jpg
SupplierId=sup-3344
```

**Respuesta 201 Created**

```json
{
  "id": "prod-887766",
  "name": "Vodka Premium 750ml",
  "type": "Vodka",
  "brand": "Nordic Spirits",
  "unitPrice": 18.99,
  "code": "VOD-750-PR",
  "minimumStock": 10,
  "totalStockInStore": 0,
  "imageUrl": "https://cdn.liquotrack.com/products/prod-887766.jpg",
  "accountId": "acc-12345",
  "supplierId": "sup-3344",
  "isInWarehouse": true
}
```

**Errores comunes**

* `400 Product could not be registered.`: Datos obligatorios ausentes, tipos inválidos o error al subir la imagen.

---

### 2. Registrar almacén para una cuenta

* **Endpoint:** `POST /api/v1/accounts/{accountId}/warehouses`
* **Descripción:** Registra un almacén físico con capacidad y rango de temperatura.

**Ruta**

```http
POST /api/v1/accounts/acc-12345/warehouses
```

**Solicitud (multipart/form-data)**

```
Name=Almacén Principal
AddressStreet=Av. Central 123
AddressCity=Lima
AddressDistrict=Miraflores
AddressPostalCode=15074
AddressCountry=Perú
TemperatureMin=15
TemperatureMax=22
Capacity=1500
Image=@/ruta/local/warehouse.jpg
```

**Respuesta 201 Created**

```json
{
  "warehouseId": "wh-445566",
  "name": "Almacén Principal",
  "addressStreet": "Av. Central 123",
  "addressCity": "Lima",
  "addressDistrict": "Miraflores",
  "addressPostalCode": "15074",
  "addressCountry": "Perú",
  "capacity": 1500,
  "temperatureMin": 15,
  "temperatureMax": 22,
  "imageUrl": "https://cdn.liquotrack.com/warehouses/wh-445566.jpg"
}
```

**Errores comunes**

* `400 Invalid input data.`: Campos faltantes, valores numéricos negativos o archivo inválido.

---
 
---

## Plans

### Obtener todos los planes disponibles

* **Endpoint:** `GET /api/v1/plans`
* **Descripción:** Devuelve el catálogo completo de planes configurados en la plataforma.

**Ruta**

```http
GET /api/v1/plans
```

**Respuesta 200 OK**

```json
[
  {
    "planId": "plan-basic",
    "planType": "BASIC",
    "description": "Plan para licorerías que recién inician.",
    "paymentFrequency": "MONTHLY",
    "price": 29.99,
    "currency": "USD",
    "maxUsers": 3,
    "maxWarehouses": 1,
    "maxProducts": 250
  },
  {
    "planId": "plan-pro",
    "planType": "PRO",
    "description": "Plan recomendado para locales con varias sucursales.",
    "paymentFrequency": "MONTHLY",
    "price": 79.99,
    "currency": "USD",
    "maxUsers": 10,
    "maxWarehouses": 5,
    "maxProducts": 1000
  }
]

```
---

**Errores comunes**

* **404 Not Found:** `No available plans found.` — No hay planes configurados en el sistema.

---

## Products

### Consultar producto por ID

* **Endpoint:** `GET /api/v1/products/{id}`
* **Descripción:** Devuelve el detalle de un producto específico registrando también su disponibilidad.

**Ruta**

```http
GET /api/v1/products/prod-887766
```

**Respuesta 200 OK**

```json
{
  "id": "prod-887766",
  "name": "Vodka Premium 750ml",
  "type": "Vodka",
  "brand": "Nordic Spirits",
  "unitPrice": 18.99,
  "code": "VOD-750-PR",
  "minimumStock": 10,
  "totalStockInStore": 85,
  "imageUrl": "https://cdn.liquotrack.com/products/prod-887766.jpg",
  "accountId": "acc-12345",
  "supplierId": "sup-3344",
  "isInWarehouse": true
}
```

**Errores comunes**

* **404 Not Found:** `Product with the specified ID was not found.` — No existe un producto asociado al identificador proporcionado.

---

## Profiles

### Consultar perfil por ID

* **Endpoint:** `GET /api/v1/profiles/{id}`
* **Descripción:** Recupera la información detallada de un perfil, incluyendo nombres, teléfonos y rol asignado.

**Ruta**

```http
GET /api/v1/profiles/prof-7821
```

**Respuesta 200 OK**

```json
{
  "id": "prof-7821",
  "firstName": "María",
  "lastName": "Ramírez",
  "fullName": "María Ramírez",
  "phoneNumber": "+51 987 654 321",
  "contactNumber": "+51 912 345 678",
  "profilePictureUrl": "https://cdn.liquotrack.com/profiles/prof-7821.jpg",
  "userId": "user-5566",
  "assignedRole": "LIQUOR_STORE_OWNER"
}
```

**Errores comunes**

* **404 Not Found:** No existe un perfil con el identificador proporcionado.

---

## Users

### Consultar usuario por ID

* **Endpoint:** `GET /api/v1/users/{userId}`
* **Descripción:** Recupera los datos básicos del usuario (username y correo) a partir de su identificador único.

**Ruta**

```http
GET /api/v1/users/user-5566
```

**Respuesta 200 OK**

```json
{
  "id": "user-5566",
  "username": "mramirez",
  "email": "maria.ramirez@licotrack.com"
}
```

**Errores comunes**

* **404 Not Found:** No existe un usuario asociado al `userId` proporcionado.

---

### Warehouses

### Eliminar almacén por ID

* **Endpoint:** `DELETE /api/v1/warehouses/{warehouseId}`
* **Descripción:** Elimina el almacén especificado y deja de estar disponible para asignaciones de productos.

**Ruta**

```http
DELETE /api/v1/warehouses/wh-445566
```

**Respuesta 204 No Content**
*No se retorna cuerpo; indica que el almacén fue eliminado correctamente.*

**Errores comunes**

* **404 Warehouse with the specified ID was not found:** El identificador no corresponde a ningún almacén activo.

---

### Authentication

### 1. Inicio de sesión con credenciales

**Endpoint:**
`POST /api/v1/sign-in`

**Descripción:**
Autentica al usuario con email y contraseña registrados.

**Solicitud**

```json
{
  "email": "propietario@licoreria.com",
  "password": "S3gura!2024"
}
```

**Respuesta 200 OK**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": "0a1b2c3d-4567-8901-2345-67890abcdef1",
  "email": "propietario@licoreria.com",
  "username": "LiquoTrack Admin"
}
```

**Errores comunes**

* **400 Bad Request:** body mal formado o credenciales faltantes.
* **401 Unauthorized:** email o contraseña incorrectos.
* **500 Internal Server Error:** error inesperado en el servicio de autenticación.

---

### 2. Registro de nuevo usuario

**Endpoint:**
`POST /api/v1/sign-up`

**Descripción:**
Crea un usuario nuevo asociándolo opcionalmente a un negocio.

**Solicitud**

```json
{
  "email": "nuevo@licoreria.com",
  "password": "ContraseñaFuerte#1",
  "name": "Ana López",
  "businessName": "Licorería El Barril",
  "role": "LIQUOR_STORE_OWNER"
}
```

**Respuesta 200 OK**
No retorna cuerpo; confirma creación exitosa. El token se obtiene luego vía `POST /api/v1/sign-in`.

**Errores comunes**

* **400 Bad Request:** datos faltantes, email duplicado o formato inválido.
* **500 Internal Server Error:** fallo al persistir el usuario.
