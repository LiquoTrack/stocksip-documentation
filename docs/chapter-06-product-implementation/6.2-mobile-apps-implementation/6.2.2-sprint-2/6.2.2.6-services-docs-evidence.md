#### 6.2.2.6. Services Documentation Evidence for Sprint Review 2 ####

En esta sección, se describe la evidencia de documentación de los endpoints que se han implementado en la API de nuestro proyecto para este sprint. A continuacion, se muestra la tabla que contiene una breve descripción de las acciones y requisitos de cada endpoint implementado.

| Módulo           | Endpoint                                                    | Acción                                                 | Verbo HTTP | Sintaxis                                                           | Parámetros principales                                                                                                                                                                           | Enlace a Swagger                                               |
|------------------|-------------------------------------------------------------|--------------------------------------------------------|------------|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
| Authentication   | /api/v1/auth/google                                         | Autenticar usuario vía Google OAuth 2.0                | POST       | `POST /api/v1/auth/google`                                         | Body (JSON): `idToken`, `accessToken`, `clientId`                                                                                                                                                | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}                           | Obtener guía de conservación por ID                    | GET        | `GET /api/v1/care-guides/{careGuideId}`                            | Path: `careGuideId`                                                                                                                                                                              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}                           | Actualizar guía de conservación                        | PUT        | `PUT /api/v1/care-guides/{careGuideId}`                            | Path: `careGuideId`<br>Body (JSON): `careGuideId`, `title`, `summary`, `recommendedMinTemperature`, `recommendedMaxTemperature`, `recommendedPlaceStorage`, `generalRecommendation`              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}                           | Eliminar guía de conservación                          | DELETE     | `DELETE /api/v1/care-guides/{careGuideId}`                         | Path: `careGuideId`                                                                                                                                                                              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}/file                      | Subir archivo PDF para una guía                        | POST       | `POST /api/v1/care-guides/{careGuideId}/file`                      | Path: `careGuideId`<br>Body (multipart/form-data): `file` (PDF)                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{accountId}                             | Crear guía por tipo de licor                           | POST       | `POST /api/v1/care-guides/{accountId}`                             | Path: `accountId`<br>Body (JSON): `typeOfLiquor`, `productName`, `title`, `summary`, `recommendedMinTemperature`, `recommendedMaxTemperature`                                                    | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{accountId}/{productType}               | Obtener guía por tipo de licor                         | GET        | `GET /api/v1/care-guides/{accountId}/{productType}`                | Path: `accountId`, `productType` (Sodas, Snacks, Wines, Rums, Whiskeys, Beers, Tequilas, Vodkas, Gins, Cocktails, Juices, SoftDrinks, Others)                                                    | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}/deallocations             | Desasignar guía de un producto                         | PUT        | `PUT /api/v1/care-guides/{careGuideId}/deallocations`              | Path: `careGuideId`                                                                                                                                                                              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Care Guides      | /api/v1/care-guides/{careGuideId}/allocations/{productId}   | Asignar guía a un producto específico                  | PUT        | `PUT /api/v1/care-guides/{careGuideId}/allocations/{productId}`    | Path: `careGuideId`, `productId`                                                                                                                                                                 | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/generate-purchase-order                      | Generar una orden de compra                            | POST       | `POST /api/v1/orders/generate-purchase-order`                      | Body (JSON): `orderCode`, `catalogToBuyFrom`, `receiptDate`, `completitionDate`, `items[]` (`productId`, `productName`, `unitPrice`, `currency`, `inventoryId`, `quantityToSell`), `isAutomatic` | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/from-procurement/completed                   | Crear Sales Order desde Procurement completado         | POST       | `POST /api/v1/orders/from-procurement/completed`                   | Body (JSON): `orderCode`, `purchaseOrderId`, `catalogIdBuyFrom`, `buyerAccountId`, `receiptDate`, `completitionDate`, `items[]` (`productId`, `quantity`, `unitPrice`, `productName`)            | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/from-procurement/{purchaseOrderId}           | Crear Sales Order automáticamente desde Purchase Order | POST       | `POST /api/v1/orders/from-procurement/{purchaseOrderId}`           | Path: `purchaseOrderId`                                                                                                                                                                          | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/{id}                                         | Obtener orden por ID                                   | GET        | `GET /api/v1/orders/{id}`                                          | Path: `id`                                                                                                                                                                                       | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders                                              | Obtener todas las órdenes                              | GET        | `GET /api/v1/orders`                                               | Sin parámetros                                                                                                                                                                                   | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/supplier/{supplierId}                        | Listar órdenes por proveedor                           | GET        | `GET /api/v1/orders/supplier/{supplierId}`                         | Path: `supplierId`                                                                                                                                                                               | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/liquor-store-owner/{liquorStoreOwnerId}      | Listar órdenes por dueño de licorería                  | GET        | `GET /api/v1/orders/liquor-store-owner/{liquorStoreOwnerId}`       | Path: `liquorStoreOwnerId`                                                                                                                                                                       | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/{orderId}/confirm                            | Confirmar una orden                                    | PUT        | `PUT /api/v1/orders/{orderId}/confirm`                             | Path: `orderId`                                                                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/{orderId}/receive                            | Marcar orden como recibida                             | PUT        | `PUT /api/v1/orders/{orderId}/receive`                             | Path: `orderId`                                                                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/{orderId}/ship                               | Marcar orden como enviada                              | PUT        | `PUT /api/v1/orders/{orderId}/ship`                                | Path: `orderId`                                                                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SalesOrder       | /api/v1/orders/{orderId}/cancel                             | Cancelar una orden                                     | PUT        | `PUT /api/v1/orders/{orderId}/cancel`                              | Path: `orderId`                                                                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SubUsers         | /api/v1/accounts/{accountId}/users                          | Crear un sub usuario dentro de una cuenta              | POST       | `POST /api/v1/accounts/{accountId}/users`                          | Path: `accountId` <br>Body (JSON): `name`, `email`, `password`, `role`, `phoneNumber`, `profileRole`                                                                                             | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| SubUsers         | /api/v1/accounts/{accountId}/users                          | Obtener todos los sub usuarios dentro de una cuenta    | POST       | `GET /api/v1/accounts/{accountId}/users`                           | Path: `accountId`                                                                                                                                                                                | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Subscriptions    | /api/v1/accounts/{accountId}/subscriptions                  | Crea una subscripción dentro de una cuenta             | POST       | `POST /api/v1/accounts/{accountId}/subscriptions`                  | Path: `accountId` <br>Body (JSON): `selectedPlanId`                                                                                                                                              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Subscriptions    | /api/v1/accounts/{accountId}/subscriptions/{subscriptionId} | Actualiza la subscripción actual de la cuenta          | PUT        | `PUT /api/v1/accounts/{accountId}/susbcriptions/{subscriptionsId}` | Path: `accountId` `subscriptionId` <br>Body (JSON): `newPlanId`                                                                                                                                  | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Recover Password | /api/v1/users/recovery-code                                 | Envía un código de verificación hacia el correo        | POST       | `POST /api/v1/users/recovery-code`                                 | Body (JSON): `email`                                                                                                                                                                             | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Recover Password | /api/v1/verify-recovery-code                                | Verifca si el codigo es válido                         | POST       | `POST /api/v1/verify-recovery-code`                                | Body (JSON): `email`, `code`                                                                                                                                                                     | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Recover Password | /api/v1/reset-password                                      | Actualiza la contraseña del usuario                    | PUT        | `PUT /api/v1/reset-password`                                       | Body (JSON): `email`, `newPassword`                                                                                                                                                              | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Catalogs         | /api/v1/catalogs/{catalogId}/publications                   | Pública un catálogo                                    | PUT        | `PUT /api/v1/catalogs/{catalogId}/publications`                    | Path: `catalogId`                                                                                                                                                                                | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Catalogs         | /api/v1/catalogs/{catalogId}/items                          | Agrega un item al catálogo                             | POST       | `POST /api/v1/catalogs/{catalogId}/items`                          | Path: `catalogId` <br>Body (JSON): `productId`, `warehouseId`, `stock`                                                                                                                           | https://stocksip-back-end.azurewebsites.net/swagger/index.html |
| Catalogs         | /api/v1/catalogs/{catalogId}/items/{productId}              | Elimina un item al catálogo                            | DELETE     | `DELETE /api/v1/catalogs/{catalogId}/items/{productId}`            | Path: `catalogId`, `productId`                                                                                                                                                                   | https://stocksip-back-end.azurewebsites.net/swagger/index.html |

## **Ejemplos Detallados**

A continuación, se presentan ejemplos detallados de algunos endpoints implementados en este sprint:

## Authentication

### 1. Autenticar usuario vía Google OAuth 2.0

**Endpoint:**
`POST /api/v1/auth/google`

**Descripción:**
Valida el token de Google del cliente y genera un JWT interno.

**Solicitud**

```json
{
  "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ij...",
  "accessToken": "ya29.a0Ael9sB...",
  "clientId": "1234567890-abcdef.apps.googleusercontent.com"
}
```

**Respuesta 200 OK**

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": "f6a5c9f1-1234-4bcd-98ef-6df4c1a2b345",
  "email": "usuario@dominio.com",
  "username": "Usuario Google"
}
```

**Errores comunes**

* **400 Bad Request:** token inválido o faltante.
* **401 Unauthorized:** token expirado o no corresponde al cliente.
* **500 / 502:** fallos internos o con el proveedor OAuth.

---

## Care Guide

### 1. Obtener guía por ID

* **Endpoint:** `GET /api/v1/care-guides/{careGuideId}`
* **Descripción:** Recupera la guía asociada a un ID específico.

**Ruta**

```http
GET /api/v1/care-guides/cg-123456
```

**Respuesta 200 OK**

```json
{
  "careGuideId": "cg-123456",
  "accountId": "acc-001",
  "productId": "prod-8899",
  "title": "Guía de almacenamiento para vinos tintos",
  "summary": "Recomendaciones de conservación para vinos tintos premium.",
  "recommendedMinTemperature": 14,
  "recommendedMaxTemperature": 18,
  "recommendedPlaceStorage": "Bodega ventilada y oscura",
  "generalRecommendation": "Mantener horizontalmente y evitar vibraciones.",
  "typeOfLiquor": "Wines",
  "productName": "Vino Tinto Reserva 2018",
  "imageUrl": "https://cdn.liquotrack.com/care-guides/cg-123456.pdf"
}
```

**Errores comunes**

* `404 Care Guide not found...`: El ID no existe para el comercio.

---

### 2. Actualizar guía de conservación

* **Endpoint:** `PUT /api/v1/care-guides/{careGuideId}`
* **Descripción:** Actualiza título, resumen y parámetros de conservación.

**Ruta**

```http
PUT /api/v1/care-guides/cg-123456
```

**Solicitud**

```json
{
  "careGuideId": "cg-123456",
  "title": "Guía actualizada para vinos tintos",
  "summary": "Actualizar las recomendaciones para la nueva cosecha.",
  "recommendedMinTemperature": 13,
  "recommendedMaxTemperature": 17,
  "recommendedPlaceStorage": "Cava con control de humedad",
  "generalRecommendation": "Verificar corchos cada seis meses."
}
```

**Respuesta 200 OK**

```json
{
  "careGuideId": "cg-123456",
  "accountId": "acc-001",
  "productId": "prod-8899",
  "title": "Guía actualizada para vinos tintos",
  "summary": "Actualizar las recomendaciones para la nueva cosecha.",
  "recommendedMinTemperature": 13,
  "recommendedMaxTemperature": 17,
  "recommendedPlaceStorage": "Cava con control de humedad",
  "generalRecommendation": "Verificar corchos cada seis meses.",
  "typeOfLiquor": "Wines",
  "productName": "Vino Tinto Reserva 2018",
  "imageUrl": "https://cdn.liquotrack.com/care-guides/cg-123456.pdf"
}
```

**Errores comunes**

* `400 Care Guide could not be updated...`: Datos faltantes o inconsistentes.
* `404 Care Guide not found...`: El ID no existe.

---

### 3. Eliminar guía de conservación

* **Endpoint:** `DELETE /api/v1/care-guides/{careGuideId}`
* **Descripción:** Quita la guía del catálogo del comercio.

**Ruta**

```http
DELETE /api/v1/care-guides/cg-123456
```

**Respuesta 204 No Content**
*No se devuelve cuerpo; indica eliminación exitosa.*

**Errores comunes**

* `404 Care Guide not found...`: El ID no existe para eliminar.

---

### 4. Subir archivo PDF asociado a la guía

* **Endpoint:** `POST /api/v1/care-guides/{careGuideId}/file`
* **Descripción:** Adjunta un PDF con instrucciones extendidas a la guía.

**Ruta**

```http
POST /api/v1/care-guides/cg-123456/file
```

**Solicitud (multipart/form-data)**

```
--boundary
Content-Disposition: form-data; name="file"; filename="guia-cg-123456.pdf"
Content-Type: application/pdf

...contenido binario del PDF...
--boundary--
```

**Respuesta 201 Created**

```json
{
  "careGuideId": "cg-123456",
  "accountId": "acc-001",
  "productId": "prod-8899",
  "title": "Guía actualizada para vinos tintos",
  "summary": "Actualizar las recomendaciones para la nueva cosecha.",
  "recommendedMinTemperature": 13,
  "recommendedMaxTemperature": 17,
  "recommendedPlaceStorage": "Cava con control de humedad",
  "generalRecommendation": "Verificar corchos cada seis meses.",
  "typeOfLiquor": "Wines",
  "productName": "Vino Tinto Reserva 2018",
  "imageUrl": "https://cdn.liquotrack.com/care-guides/cg-123456.pdf"
}
```

**Errores comunes**

* `400 Invalid file format or request`: El archivo no es PDF o falta el campo `file`.
* `404 Care Guide not found`: La guía no existe.

---

### 5. Crear guía según tipo de licor

* **Endpoint:** `POST /api/v1/care-guides/{accountId}`
* **Descripción:** Crea una guía nueva basada en el tipo de licor para una cuenta.

**Ruta**

```http
POST /api/v1/care-guides/acc-001
```

**Solicitud**

```json
{
  "typeOfLiquor": "Whiskeys",
  "productName": "Whisky Single Malt 12 años",
  "title": "Conservación de whiskies premium",
  "summary": "Indicaciones para preservar whiskies de alta gama.",
  "recommendedMinTemperature": 18,
  "recommendedMaxTemperature": 22
}
```

**Respuesta 201 Created**

```json
{
  "careGuideId": "cg-789012",
  "accountId": "acc-001",
  "productId": "prod-5566",
  "title": "Conservación de whiskies premium",
  "summary": "Indicaciones para preservar whiskies de alta gama.",
  "recommendedMinTemperature": 18,
  "recommendedMaxTemperature": 22,
  "recommendedPlaceStorage": "Estante fresco y sin luz directa",
  "generalRecommendation": "Mantener la botella en posición vertical.",
  "typeOfLiquor": "Whiskeys",
  "productName": "Whisky Single Malt 12 años",
  "imageUrl": "https://cdn.liquotrack.com/care-guides/cg-789012.pdf"
}
```

**Errores comunes**

* `400 Invalid request...`: Datos incompletos o tipo de licor no soportado.
* `404 Account not found...`: La cuenta no existe.

---

### 6. Obtener guía por tipo de licor

* **Endpoint:** `GET /api/v1/care-guides/{accountId}/{productType}`
* **Descripción:** Devuelve la guía para un tipo de licor dentro de la cuenta.

**Ruta**

```http
GET /api/v1/care-guides/acc-001/Whiskeys
```

**Respuesta 200 OK**

```json
{
  "careGuideId": "cg-789012",
  "accountId": "acc-001",
  "productId": "prod-5566",
  "title": "Conservación de whiskies premium",
  "summary": "Indicaciones para preservar whiskies de alta gama.",
  "recommendedMinTemperature": 18,
  "recommendedMaxTemperature": 22,
  "recommendedPlaceStorage": "Estante fresco y sin luz directa",
  "generalRecommendation": "Mantener la botella en posición vertical.",
  "typeOfLiquor": "Whiskeys",
  "productName": "Whisky Single Malt 12 años",
  "imageUrl": "https://cdn.liquotrack.com/care-guides/cg-789012.pdf"
}
```

**Errores comunes**

* `404 Care Guide not found...`: No existe guía para el tipo solicitado.

---

### 7. Desasignar guía de un producto

* **Endpoint:** `PUT /api/v1/care-guides/{careGuideId}/deallocations`
* **Descripción:** Retira la relación entre la guía y el producto asociado.

**Ruta**

```http
PUT /api/v1/care-guides/cg-123456/deallocations
```

**Respuesta 200 OK**

```json
{
  "message": "Care Guide unassigned successfully!"
}
```

**Errores comunes**

* `400 Care Guide could not be unassign...`: El estado actual no permite la desasignación.
* `404 Care Guide not found...`: La guía no existe.

---

### 8. Asignar guía a un producto específico

* **Endpoint:** `PUT /api/v1/care-guides/{careGuideId}/allocations/{productId}`
* **Descripción:** Vincula la guía a un producto determinado.

**Ruta**

```http
PUT /api/v1/care-guides/cg-123456/allocations/prod-9900
```

**Respuesta 200 OK**

```json
{
  "message": "Care Guide assigned successfully!",
  "careGuideId": "cg-123456",
  "productId": "prod-9900"
}
```

**Errores comunes**

* `400 Care Guide could not be assigned...`: El producto ya tiene guía o datos inválidos.
* `404 Care Guide not found...`: La guía o el producto no existen.

---

## Sales Order

### 1. Generar orden de compra

* **Endpoint:** `POST /api/v1/orders/generate-purchase-order`
* **Descripción:** Crea una orden de compra manual o automática con los ítems seleccionados.

**Solicitud**

```json
{
  "orderCode": "PO-2025-001",
  "catalogToBuyFrom": "CAT-SUP-001",
  "receiptDate": "2025-11-30T15:00:00Z",
  "completitionDate": "2025-12-05T18:00:00Z",
  "items": [
    {
      "productId": "PROD-1001",
      "productName": "Whisky Glenfiddich 12 años",
      "unitPrice": 120.5,
      "currency": "USD",
      "inventoryId": "INV-5678",
      "quantityToSell": 24
    }
  ],
  "isAutomatic": false
}
```

**Respuesta 201 Created**

```json
{
  "id": "SO-987654",
  "orderCode": "PO-2025-001",
  "purchaseOrderId": "POI-445566",
  "items": [
    {
      "productId": "PROD-1001",
      "productName": "Whisky Glenfiddich 12 años",
      "unitPrice": 120.5,
      "currency": "USD",
      "inventoryId": "INV-5678",
      "quantityToSell": 24
    }
  ],
  "status": "PENDING_CONFIRMATION",
  "catalogToBuyFrom": "CAT-SUP-001",
  "receiptDate": "2025-11-30T15:00:00Z",
  "completitionDate": "2025-12-05T18:00:00Z",
  "buyer": "acc-0987",
  "deliveryProposal": {
    "proposedDate": "2025-12-04T12:00:00Z",
    "notes": "Entrega parcial disponible",
    "status": "PROPOSED",
    "createdAt": "2025-11-09T12:30:00Z",
    "respondedAt": null
  },
  "supplierId": "sup-2200"
}
```

**Errores comunes:** `400 Invalid request data`, `401 User not authenticated`, `403 User does not have permission`.

---

### 2. Crear Sales Order desde Procurement completado

* **Endpoint:** `POST /api/v1/orders/from-procurement/completed`
* **Descripción:** Genera la orden de venta a partir del payload final enviado por Procurement.

**Solicitud**

```json
{
  "orderCode": "SO-2025-015",
  "purchaseOrderId": "POI-998877",
  "catalogIdBuyFrom": "CAT-SUP-005",
  "buyerAccountId": "acc-1200",
  "receiptDate": "2025-11-15T10:00:00Z",
  "completitionDate": "2025-11-20T18:00:00Z",
  "items": [
    {
      "productId": "PROD-3002",
      "quantity": 12,
      "unitPrice": 18.99,
      "productName": "Vodka Premium 750ml"
    }
  ]
}
```

**Respuesta 201 Created**

```json
{
  "id": "SO-556677",
  "orderCode": "SO-2025-015",
  "purchaseOrderId": "POI-998877",
  "items": [
    {
      "productId": "PROD-3002",
      "productName": "Vodka Premium 750ml",
      "unitPrice": 18.99,
      "currency": "USD",
      "inventoryId": "INV-7432",
      "quantityToSell": 12
    }
  ],
  "status": "PENDING_CONFIRMATION",
  "catalogToBuyFrom": "CAT-SUP-005",
  "receiptDate": "2025-11-15T10:00:00Z",
  "completitionDate": "2025-11-20T18:00:00Z",
  "buyer": "acc-1200",
  "deliveryProposal": {
    "proposedDate": "2025-11-19T10:30:00Z",
    "notes": "Entrega total en una sola visita",
    "status": "PROPOSED",
    "createdAt": "2025-11-09T13:00:00Z",
    "respondedAt": null
  },
  "supplierId": "sup-3344"
}
```

**Errores comunes:** `400 Invalid request data`.

---

### 3. Crear Sales Order automáticamente desde Purchase Order

* **Endpoint:** `POST /api/v1/orders/from-procurement/{purchaseOrderId}`
* **Descripción:** Usa el ID de Purchase Order para generar la Sales Order sin payload adicional.

**Ruta**

```http
POST /api/v1/orders/from-procurement/POI-445566
```

**Respuesta 201 Created**

```json
{
  "id": "SO-445566",
  "orderCode": "SO-2025-018",
  "purchaseOrderId": "POI-445566",
  "items": [
    {
      "productId": "PROD-1001",
      "productName": "Whisky Glenfiddich 12 años",
      "unitPrice": 120.5,
      "currency": "USD",
      "inventoryId": "INV-5678",
      "quantityToSell": 24
    }
  ],
  "status": "PENDING_CONFIRMATION",
  "catalogToBuyFrom": "CAT-SUP-001",
  "receiptDate": "2025-11-30T15:00:00Z",
  "completitionDate": "2025-12-05T18:00:00Z",
  "buyer": "acc-0987",
  "deliveryProposal": {
    "proposedDate": "2025-12-04T12:00:00Z",
    "notes": "Entrega parcial disponible",
    "status": "PROPOSED",
    "createdAt": "2025-11-09T12:30:00Z",
    "respondedAt": null
  },
  "supplierId": "sup-2200"
}
```

**Errores comunes:** `400 Invalid request or validation error`, `404 Purchase Order not found`.

---

### 4. Obtener orden por ID

* **Endpoint:** `GET /api/v1/orders/{id}`
* **Descripción:** Devuelve el detalle completo de una orden de venta.

**Ruta**

```http
GET /api/v1/orders/SO-556677
```

**Respuesta 200 OK**

```json
{
  "id": "SO-556677",
  "orderCode": "SO-2025-015",
  "purchaseOrderId": "POI-998877",
  "items": [
    {
      "productId": "PROD-3002",
      "productName": "Vodka Premium 750ml",
      "unitPrice": 18.99,
      "currency": "USD",
      "inventoryId": "INV-7432",
      "quantityToSell": 12
    }
  ],
  "status": "PENDING_CONFIRMATION",
  "catalogToBuyFrom": "CAT-SUP-005",
  "receiptDate": "2025-11-15T10:00:00Z",
  "completitionDate": "2025-11-20T18:00:00Z",
  "buyer": "acc-1200",
  "deliveryProposal": {
    "proposedDate": "2025-11-19T10:30:00Z",
    "notes": "Entrega total en una sola visita",
    "status": "PROPOSED",
    "createdAt": "2025-11-09T13:00:00Z",
    "respondedAt": null
  },
  "supplierId": "sup-3344"
}
```

**Errores comunes:** `404 Order not found`.

---

### 5. Listar todas las órdenes

* **Endpoint:** `GET /api/v1/orders`
* **Descripción:** Lista todas las órdenes disponibles para el usuario autenticado.

**Ruta**

```http
GET /api/v1/orders
```

**Respuesta 200 OK**

```json
[
  {
    "id": "SO-556677",
    "orderCode": "SO-2025-015",
    "purchaseOrderId": "POI-998877",
    "items": [
      {
        "productId": "PROD-3002",
        "productName": "Vodka Premium 750ml",
        "unitPrice": 18.99,
        "currency": "USD",
        "inventoryId": "INV-7432",
        "quantityToSell": 12
      }
    ],
    "status": "PENDING_CONFIRMATION",
    "catalogToBuyFrom": "CAT-SUP-005",
    "receiptDate": "2025-11-15T10:00:00Z",
    "completitionDate": "2025-11-20T18:00:00Z",
    "buyer": "acc-1200",
    "deliveryProposal": {
      "proposedDate": "2025-11-19T10:30:00Z",
      "notes": "Entrega total en una sola visita",
      "status": "PROPOSED",
      "createdAt": "2025-11-09T13:00:00Z",
      "respondedAt": null
    },
    "supplierId": "sup-3344"
  }
]
```

---

### 6. Listar órdenes por proveedor

* **Endpoint:** `GET /api/v1/orders/supplier/{supplierId}`
* **Descripción:** Muestra todas las órdenes asociadas a un proveedor.

**Ruta**

```http
GET /api/v1/orders/supplier/sup-3344
```

**Respuesta 200 OK**

```json
{
  "supplierId": "sup-3344",
  "orders": [
    {
      "id": "SO-556677",
      "orderCode": "SO-2025-015",
      "purchaseOrderId": "POI-998877",
      "items": [
        {
          "productId": "PROD-3002",
          "productName": "Vodka Premium 750ml",
          "unitPrice": 18.99,
          "currency": "USD",
          "inventoryId": "INV-7432",
          "quantityToSell": 12
        }
      ],
      "status": "PENDING_CONFIRMATION",
      "catalogToBuyFrom": "CAT-SUP-005",
      "receiptDate": "2025-11-15T10:00:00Z",
      "completitionDate": "2025-11-20T18:00:00Z",
      "buyer": "acc-1200",
      "deliveryProposal": {
        "proposedDate": "2025-11-19T10:30:00Z",
        "notes": "Entrega total en una sola visita",
        "status": "PROPOSED",
        "createdAt": "2025-11-09T13:00:00Z",
        "respondedAt": null
      },
      "supplierId": "sup-3344"
    }
  ],
  "totalOrders": 1,
  "message": "Orders retrieved successfully."
}
```

**Errores comunes:** `400 Invalid supplier ID`.

---

### 7. Listar órdenes por dueño de licorería

* **Endpoint:** `GET /api/v1/orders/liquor-store-owner/{liquorStoreOwnerId}`
* **Descripción:** Devuelve las órdenes de un propietario de licorería.

**Ruta**

```http
GET /api/v1/orders/liquor-store-owner/owner-4455
```

**Respuesta 200 OK**

```json
{
  "liquorStoreOwnerId": "owner-4455",
  "orders": [
    {
      "id": "SO-556677",
      "orderCode": "SO-2025-015",
      "purchaseOrderId": "POI-998877",
      "items": [
        {
          "productId": "PROD-3002",
          "productName": "Vodka Premium 750ml",
          "unitPrice": 18.99,
          "currency": "USD",
          "inventoryId": "INV-7432",
          "quantityToSell": 12
        }
      ],
      "status": "PENDING_CONFIRMATION",
      "catalogToBuyFrom": "CAT-SUP-005",
      "receiptDate": "2025-11-15T10:00:00Z",
      "completitionDate": "2025-11-20T18:00:00Z",
      "buyer": "acc-1200",
      "deliveryProposal": {
        "proposedDate": "2025-11-19T10:30:00Z",
        "notes": "Entrega total en una sola visita",
        "status": "PROPOSED",
        "createdAt": "2025-11-09T13:00:00Z",
        "respondedAt": null
      },
      "supplierId": "sup-3344"
    }
  ],
  "totalOrders": 1,
  "message": "Orders retrieved successfully."
}
```

**Errores comunes:** `400 Invalid Liquor Store Owner ID`, `403 User does not have permission`.

---

### 8. Confirmar orden

* **Endpoint:** `PUT /api/v1/orders/{orderId}/confirm`
* **Descripción:** Cambia el estado de la orden a **CONFIRMED**.

**Ruta**

```http
PUT /api/v1/orders/SO-556677/confirm
```

**Respuesta 204 No Content**

**Errores comunes:** `400 Invalid request`, `404 Order not found`.

---

### 9. Marcar orden como recibida

* **Endpoint:** `PUT /api/v1/orders/{orderId}/receive`
* **Descripción:** Actualiza el estado a **RECEIVED** cuando el comprador recibe la mercancía.

**Ruta**

```http
PUT /api/v1/orders/SO-556677/receive
```

**Respuesta 204 No Content**

**Errores comunes:** `400 Invalid request`, `404 Order not found`.

---

### 10. Marcar orden como enviada

* **Endpoint:** `PUT /api/v1/orders/{orderId}/ship`
* **Descripción:** Registra que la orden salió del almacén del proveedor.

**Ruta**

```http
PUT /api/v1/orders/SO-556677/ship
```

**Respuesta 204 No Content**

**Errores comunes:** `400 Invalid request`, `404 Order not found`.

---

### 11. Cancelar orden

* **Endpoint:** `PUT /api/v1/orders/{orderId}/cancel`
* **Descripción:** Cambia el estado a **CANCELED**.

**Ruta**

```http
PUT /api/v1/orders/SO-556677/cancel
```

**Respuesta 204 No Content**

**Errores comunes:** `400 Invalid request`, `404 Order not found`.

---

## SubUsers

### 1. Crear subusuario dentro de una cuenta

**Endpoint:** `POST /api/v1/accounts/{accountId}/users`  
**Descripción:** Crea un subusuario dentro de una cuenta específica.

#### Solicitud
```json
{
  "name": "Carlos Mendoza",
  "email": "carlos.mendoza@example.com",
  "password": "MyStrongP@ss123",
  "role": "Admin",
  "phoneNumber": "+51987654321",
  "profileRole": "WarehouseManager"
}
```

Respuesta 201 Created
```json
{
  "message": "Sub user registered successfully."
}
```

**Errores comunes:** `400 Invalid request`, `401 User not authenticated`.

### 2. Obtener todos los sub usuarios dentro de una cuenta

**Endpoint:** `GET /api/v1/accounts/{accountId}/users`  
**Descripción:** Obtiene todos los sub usuarios dentro de una cuenta específica.

#### Solicitud
```json
[
  {
    "maxUsersAllowed": 0,
    "totalUsers": 0,
    "users": [
      {
        "userId": "string",
        "email": "string",
        "role": "string",
        "profileId": "string",
        "fullName": "string",
        "phoneNumber": "string",
        "profilePictureUrl": "string",
        "profileRole": "string"
      }
    ]
  }
]
```

Respuesta 201 Created
```json
[
  {
    "maxUsersAllowed": 5,
    "totalUsers": 1,
    "users": [
      {
        "userId": "1287283712832",
        "email": "matias@gmail.com",
        "role": "Admin",
        "profileId": "2219382",
        "fullName": "Matias Diaz",
        "phoneNumber": "+51 912 282 282",
        "profilePictureUrl": "https://res.cloudinary.com/deuy1pr9e/image/upload/v1759710739/Default-profile_xbpv55.jpg",
        "profileRole": "WarehouseManager"
      }
    ]
  }
]
```

**Errores comunes:** `400 Invalid request`, `401 User not authenticated`, `401 User not authenticated`.

---

## Subscriptions

### 1. Crear una subscripción dentro de una cuenta

**Endpoint:** `POST /api/v1/accounts/{accountId}/subscriptions`  
**Descripción:** Crea una nueva subscripción para la cuenta especificada.

#### Solicitud
```json
{
  "selectedPlanId": "plan-premium-2025"
}
```

Respuesta 201 Created
```json
{
  "preferenceId": "128217328",
  "initPoint": "https://www.mercadopago.com.pe/checkout/v1/redirect?pref_id=128217328-fb12a98d-4a89-4a0e-91ab-3e8a4c91b9e3",
  "message": "Subscription created successfully."
}
```

**Errores comunes:** `400 Invalid request`, `401 User not authenticated`.

### 2. Actualizar la subscripción actual de la cuenta

**Endpoint:** `PUT /api/v1/accounts/{accountId}/subscriptions/{subscriptionId}`  
**Descripción:** Actualiza la subscripción existente de la cuenta a un nuevo plan.

#### Solicitud
```
{
  "newPlanId": "plan-enterprise-2025"
}
```

Respuesta 201 Created
```json
{
  "preferenceId": "292839230",
  "initPoint": "https://www.mercadopago.com.pe/checkout/v1/redirect?pref_id=292839230-fb12a98d-4a89-4a0e-91ab-3e8a4c91b9e3",
  "message": "Subscription created successfully."
}
```

**Errores comunes:** `400 Invalid request`, `401 User not authenticated`.

---

## Recover Password

### 1. Enviar código de recuperación al correo

**Endpoint:** `POST /api/v1/users/recovery-code`  
**Descripción:** Envía un código de verificación temporal de 6 dígitos al correo del usuario para iniciar el proceso de recuperación de contraseña.

#### Solicitud
```json
{
  "email": "usuario@example.com"
}
```

Respuesta 200 Ok
```json
{
  "message": "Recovery code sent successfully"
}
```

**Errores comunes:** `400 Invalid request`.

### 2. Verificar código de recuperación

**Endpoint:** `POST /api/v1/verify-recovery-code`  
**Descripción:** Verifica si el código de recuperación ingresado es válido y no ha expirado.

#### Solicitud
```json
{
  "email": "usuario@example.com",
  "code": "482019"
}
```

Respuesta 200 OK
```json
{
  "message": "Recovery code verified successfully"
}
```

**Errores comunes:** `400 Invalid request`, `404 Code not found`, `410 Code expired`.

### 3. Actualizar contraseña del usuario

**Endpoint:** `PUT /api/v1/reset-password`  
**Descripción:** Permite al usuario establecer una nueva contraseña después de validar correctamente el código de recuperación.

#### Solicitud
```json
{
  "email": "usuario@example.com",
  "newPassword": "MyNewStrongP@ssword2025"
}
```

Respuesta 201 Created
```json
{
  "message": "Password updated successfully"
}
```

**Errores comunes:** `400 Invalid request`, `404 User not found`.

---

## Catalogs

### 1. Publicar un catálogo

**Endpoint:** `PUT /api/v1/catalogs/{catalogId}/publications`  
**Descripción:** Cambia el estado del catálogo a “publicado”, haciéndolo visible para los dueños de licorería.

#### Ruta

```http
PUT /api/v1/catalogs/{catalogId}/publications
```

Respuesta 200 Ok
```json
{
  "message": "Catalog published successfully."
}
```

**Errores comunes:** `400 Invalid data`, `401 Unauthorized`, `404 Catalog not found`.

### 2. Agregar un ítem al catálogo

**Endpoint:** `POST /api/v1/catalogs/{catalogId}/items`  
**Descripción:** Agrega un nuevo producto existente del inventario a un catálogo para su venta o visualización.

#### Solicitud
```json
{
  "productId": "string",
  "warehouseId": "string",
  "stock": 0
}
```

Respuesta 200 OK
```json
{
  "id": "string",
  "name": "string",
  "description": "string",
  "catalogItems": [
    {
      "productId": "string",
      "amount": 0,
      "currency": "string",
      "addedDate": "2025-11-11T02:09:20.941Z",
      "productName": "string",
      "productImage": "string"
    }
  ],
  "ownerAccount": "string",
  "contactEmail": "string",
  "isPublished": true
}
```

**Errores comunes:** `400 Invalid request`, `404 Catalog not found`, `410 Code expired`.

### 3. Eliminar un ítem del catálogo

**Endpoint:** `DELETE /api/v1/catalogs/{catalogId}/items/{productId}`  
**Descripción:** Elimina un producto previamente agregado al catálogo.

```http
DELETE /api/v1/catalogs/{catalogId}/items/{productId}
```

Respuesta 200 OK
```json
{
  "message": "Item removed successfully."
}
```

**Errores comunes:** `400 Invalid request`, `404 Catalog or product not found`.

